# ğŸ§ª ãƒ†ã‚¹ãƒˆåŸºæœ¬è¨­è¨ˆæ›¸ï¼ˆMVPç‰ˆï¼‰
# ãŠã¤ã‹ã„ãƒã‚¤ãƒ³ãƒˆ MVPç‰ˆ

---

## ğŸ“„ æ–‡æ›¸æƒ…å ±

| é …ç›® | å†…å®¹ |
|------|------|
| **æ–‡æ›¸ã‚¿ã‚¤ãƒˆãƒ«** | ãŠã¤ã‹ã„ãƒã‚¤ãƒ³ãƒˆ ãƒ†ã‚¹ãƒˆåŸºæœ¬è¨­è¨ˆæ›¸ï¼ˆMVPç‰ˆï¼‰ |
| **ãƒãƒ¼ã‚¸ãƒ§ãƒ³** | v1.0 |
| **ä½œæˆæ—¥** | 2025å¹´09æœˆ28æ—¥ |
| **ä½œæˆè€…** | QAã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ |
| **æ‰¿èªçŠ¶æ³** | ãƒ‰ãƒ©ãƒ•ãƒˆ |
| **å¯¾è±¡èª­è€…** | æŠ€è¡“ãƒãƒ¼ãƒ ãƒªãƒ¼ãƒ€ãƒ¼ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã€DevOpsã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ |

---

## ğŸ¯ 1. ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ï¼ˆMVPé‡è¦–ï¼‰

### 1.1 MVPåˆ¶ç´„ã¨ãƒ†ã‚¹ãƒˆæ–¹é‡
- **ãƒ†ã‚¹ãƒˆç¯„å›²**: 5ç”»é¢é™å®šï¼ˆãƒ­ã‚°ã‚¤ãƒ³ã€ãƒªã‚¹ãƒˆè¡¨ç¤ºã€ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ ã€QRã‚³ãƒ¼ãƒ‰ã€è¨­å®šï¼‰
- **ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«**: 4å€‹ã®ã¿ï¼ˆflutter_test, integration_test, mockito, patrolï¼‰
- **ã‚³ãƒ¼ãƒ‰åˆ¶é™**: ç·ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰300è¡Œä»¥å†…
- **å®Ÿè¡Œæ™‚é–“**: 5åˆ†ä»¥å†…ã®é«˜é€Ÿãƒ†ã‚¹ãƒˆ

### 1.2 ãƒªã‚¹ã‚¯åˆ†æã¨ãƒ†ã‚¹ãƒˆå„ªå…ˆåº¦

#### ğŸ”´ é«˜ãƒªã‚¹ã‚¯ï¼ˆå¿…é ˆãƒ†ã‚¹ãƒˆï¼‰
- **Google OAuthèªè¨¼**: ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ã§ã‚¢ãƒ—ãƒªä½¿ç”¨ä¸å¯
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸ**: è¦ªå­é–“ãƒ‡ãƒ¼ã‚¿åŒæœŸå¤±æ•—
- **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§**: ã‚¢ã‚¤ãƒ†ãƒ çŠ¶æ…‹ã®ä¸æ•´åˆ

#### ğŸŸ¡ ä¸­ãƒªã‚¹ã‚¯ï¼ˆé‡è¦ãƒ†ã‚¹ãƒˆï¼‰
- **QRã‚³ãƒ¼ãƒ‰æ©Ÿèƒ½**: å®¶æ—æ‹›å¾…æ©Ÿèƒ½ã®å¤±æ•—
- **ã‚¢ã‚¤ãƒ†ãƒ æ“ä½œ**: CRUDæ“ä½œã®ä¸å…·åˆ

#### ğŸŸ¢ ä½ãƒªã‚¹ã‚¯ï¼ˆæœ€å°é™ãƒ†ã‚¹ãƒˆï¼‰
- **UIè¡¨ç¤º**: Material Designæ¨™æº–ä½¿ç”¨ã§ä½ãƒªã‚¹ã‚¯
- **è¨­å®šæ©Ÿèƒ½**: ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã®ã¿ã®å˜ç´”æ©Ÿèƒ½

### 1.3 ãƒ†ã‚¹ãƒˆæˆ¦ç•¥
- **ãƒªã‚¹ã‚¯ãƒ™ãƒ¼ã‚¹**: é«˜ãƒªã‚¹ã‚¯æ©Ÿèƒ½ã«80%ã®ãƒ†ã‚¹ãƒˆå·¥æ•°é›†ä¸­
- **MVPé©åˆ**: éåº¦ãªãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã¯ä½œæˆã—ãªã„
- **æ®µéšçš„å®Ÿè¡Œ**: å®Ÿè£…å®Œäº†éƒ¨åˆ†ã‹ã‚‰æ®µéšçš„ãƒ†ã‚¹ãƒˆé–‹å§‹
- **è‡ªå‹•åŒ–å„ªå…ˆ**: ç¹°ã‚Šè¿”ã—å¯èƒ½ãªãƒ†ã‚¹ãƒˆã¯è‡ªå‹•åŒ–

---

## ğŸ”§ 2. å˜ä½“ãƒ†ã‚¹ãƒˆè¨­è¨ˆï¼ˆ80è¡Œï¼‰

### 2.1 ãƒ†ã‚¹ãƒˆå¯¾è±¡ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆ3å€‹ï¼‰

#### 2.1.1 AuthService ãƒ†ã‚¹ãƒˆï¼ˆ25è¡Œï¼‰
```dart
// test/services/auth_service_test.dart
group('AuthService', () {
  late AuthService authService;
  late MockSupabaseClient mockClient;
  
  setUp(() {
    mockClient = MockSupabaseClient();
    authService = AuthService();
  });
  
  test('signInWithGoogleæˆåŠŸ', () async {
    // Google OAuthæˆåŠŸã®ãƒ†ã‚¹ãƒˆ
    when(mockClient.auth.signInWithOAuth(OAuthProvider.google))
        .thenAnswer((_) async => AuthResponse());
    
    await authService.signInWithGoogle();
    verify(mockClient.auth.signInWithOAuth(OAuthProvider.google));
  });
  
  test('signOutæˆåŠŸ', () async {
    // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæˆåŠŸã®ãƒ†ã‚¹ãƒˆ
    when(mockClient.auth.signOut()).thenAnswer((_) async => {});
    
    await authService.signOut();
    verify(mockClient.auth.signOut());
  });
  
  test('isAuthenticatedåˆ¤å®š', () {
    // èªè¨¼çŠ¶æ…‹åˆ¤å®šã®ãƒ†ã‚¹ãƒˆ
    when(mockClient.auth.currentUser).thenReturn(mockUser);
    expect(authService.isAuthenticated, true);
  });
});
```

#### 2.1.2 DataService ãƒ†ã‚¹ãƒˆï¼ˆ30è¡Œï¼‰
```dart
// test/services/data_service_test.dart
group('DataService', () {
  late DataService dataService;
  late MockSupabaseClient mockClient;
  
  test('createFamilyæˆåŠŸ', () async {
    // å®¶æ—ä½œæˆæˆåŠŸã®ãƒ†ã‚¹ãƒˆ
    final mockResponse = {'id': 'family-123', 'name': 'ãƒ†ã‚¹ãƒˆå®¶æ—'};
    when(mockClient.from('families').insert(any).select().single())
        .thenAnswer((_) async => mockResponse);
    
    final familyId = await dataService.createFamily('ãƒ†ã‚¹ãƒˆå®¶æ—');
    expect(familyId, 'family-123');
  });
  
  test('getListsæˆåŠŸ', () async {
    // ãƒªã‚¹ãƒˆå–å¾—æˆåŠŸã®ãƒ†ã‚¹ãƒˆ
    final mockLists = [{'id': 'list-1', 'title': 'ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆ'}];
    when(mockClient.from('shopping_lists').select().eq('family_id', any))
        .thenAnswer((_) async => mockLists);
    
    final lists = await dataService.getLists('family-123');
    expect(lists.length, 1);
    expect(lists.first['title'], 'ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆ');
  });
  
  test('addItemæˆåŠŸ', () async {
    // ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ æˆåŠŸã®ãƒ†ã‚¹ãƒˆ
    when(mockClient.from('shopping_items').insert(any))
        .thenAnswer((_) async => {});
    
    await dataService.addItem('list-1', 'ç‰›ä¹³');
    verify(mockClient.from('shopping_items').insert(any));
  });
  
  test('completeItemæˆåŠŸ', () async {
    // ã‚¢ã‚¤ãƒ†ãƒ å®Œäº†æˆåŠŸã®ãƒ†ã‚¹ãƒˆ
    when(mockClient.from('shopping_items').update(any).eq('id', any))
        .thenAnswer((_) async => {});
    
    await dataService.completeItem('item-1');
    verify(mockClient.from('shopping_items').update({'status': 'completed'}).eq('id', 'item-1'));
  });
});
```

#### 2.1.3 RealtimeService ãƒ†ã‚¹ãƒˆï¼ˆ25è¡Œï¼‰
```dart
// test/services/realtime_service_test.dart
group('RealtimeService', () {
  late RealtimeService realtimeService;
  late MockSupabaseClient mockClient;
  
  test('subscribeToListæˆåŠŸ', () {
    // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è³¼èª­æˆåŠŸã®ãƒ†ã‚¹ãƒˆ
    final mockChannel = MockRealtimeChannel();
    when(mockClient.channel('list_123')).thenReturn(mockChannel);
    when(mockChannel.on(any, any, any)).thenReturn(mockChannel);
    when(mockChannel.subscribe()).thenReturn(mockChannel);
    
    bool callbackCalled = false;
    realtimeService.subscribeToList('123', (data) => callbackCalled = true);
    
    verify(mockClient.channel('list_123'));
    verify(mockChannel.subscribe());
  });
  
  test('unsubscribeæˆåŠŸ', () {
    // è³¼èª­è§£é™¤æˆåŠŸã®ãƒ†ã‚¹ãƒˆ
    final mockChannel = MockRealtimeChannel();
    realtimeService.channels['list_123'] = mockChannel;
    
    realtimeService.unsubscribe('123');
    verify(mockClient.removeChannel(mockChannel));
  });
});
```

### 2.2 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆï¼ˆ10å€‹é™å®šï¼‰
```dart
// test/components/widgets_test.dart
group('MVPã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ', () {
  testWidgets('OPButtonè¡¨ç¤º', (tester) async {
    await tester.pumpWidget(MaterialApp(
      home: OPButton(label: 'ãƒ†ã‚¹ãƒˆ', onPressed: () {}),
    ));
    expect(find.text('ãƒ†ã‚¹ãƒˆ'), findsOneWidget);
  });
  
  testWidgets('OPTextFieldå…¥åŠ›', (tester) async {
    final controller = TextEditingController();
    await tester.pumpWidget(MaterialApp(
      home: OPTextField(labelText: 'ãƒ†ã‚¹ãƒˆ', controller: controller),
    ));
    
    await tester.enterText(find.byType(TextFormField), 'ãƒ†ã‚¹ãƒˆå…¥åŠ›');
    expect(controller.text, 'ãƒ†ã‚¹ãƒˆå…¥åŠ›');
  });
  
  testWidgets('OPListTileãƒã‚§ãƒƒã‚¯', (tester) async {
    bool toggled = false;
    await tester.pumpWidget(MaterialApp(
      home: OPListTile(
        title: 'ãƒ†ã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ ',
        completed: false,
        onToggle: () => toggled = true,
      ),
    ));
    
    await tester.tap(find.byType(Checkbox));
    expect(toggled, true);
  });
});
```

### 2.3 ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™
- **ã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆ**: 90%ä»¥ä¸Šï¼ˆèªè¨¼ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰
- **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ**: 80%ä»¥ä¸Šï¼ˆ10ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰
- **ç·åˆã‚«ãƒãƒ¬ãƒƒã‚¸**: 80%ä»¥ä¸Š

---

## ğŸ”— 3. çµåˆãƒ†ã‚¹ãƒˆè¨­è¨ˆï¼ˆ60è¡Œï¼‰

### 3.1 Supabaseé€£æºãƒ†ã‚¹ãƒˆ

#### 3.1.1 èªè¨¼ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆï¼ˆ20è¡Œï¼‰
```dart
// integration_test/auth_flow_test.dart
group('èªè¨¼ãƒ•ãƒ­ãƒ¼çµåˆãƒ†ã‚¹ãƒˆ', () {
  testWidgets('Google OAuth â†’ ãƒ›ãƒ¼ãƒ ç”»é¢é·ç§»', (tester) async {
    await tester.pumpWidget(MyApp());
    
    // ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ—
    await tester.tap(find.text('Googleã§ãƒ­ã‚°ã‚¤ãƒ³'));
    await tester.pumpAndSettle();
    
    // èªè¨¼æˆåŠŸå¾Œã€ãƒªã‚¹ãƒˆç”»é¢ã«é·ç§»ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
    expect(find.text('ãŠè²·ã„ç‰©ãƒªã‚¹ãƒˆ'), findsOneWidget);
    expect(find.byType(FloatingActionButton), findsOneWidget);
  });
  
  testWidgets('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ â†’ ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢æˆ»ã‚Š', (tester) async {
    // äº‹å‰ã«ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã«ã™ã‚‹
    await AuthService().signInWithGoogle();
    await tester.pumpWidget(MyApp());
    
    // è¨­å®šç”»é¢ã‹ã‚‰ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
    await tester.tap(find.byIcon(Icons.settings));
    await tester.tap(find.text('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ'));
    await tester.pumpAndSettle();
    
    // ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«æˆ»ã‚‹ã“ã¨ã‚’ç¢ºèª
    expect(find.text('Googleã§ãƒ­ã‚°ã‚¤ãƒ³'), findsOneWidget);
  });
});
```

#### 3.1.2 ãƒ‡ãƒ¼ã‚¿æ“ä½œé€£æºãƒ†ã‚¹ãƒˆï¼ˆ25è¡Œï¼‰
```dart
// integration_test/data_integration_test.dart
group('ãƒ‡ãƒ¼ã‚¿æ“ä½œçµåˆãƒ†ã‚¹ãƒˆ', () {
  testWidgets('ãƒªã‚¹ãƒˆä½œæˆ â†’ ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ  â†’ å®Œäº†', (tester) async {
    await tester.pumpWidget(MyApp());
    
    // äº‹å‰ã«ãƒ­ã‚°ã‚¤ãƒ³
    await AuthService().signInWithGoogle();
    await tester.pumpAndSettle();
    
    // ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ 
    await tester.tap(find.byType(FloatingActionButton));
    await tester.enterText(find.byType(TextField), 'ãƒ†ã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ ');
    await tester.tap(find.text('è¿½åŠ '));
    await tester.pumpAndSettle();
    
    // ã‚¢ã‚¤ãƒ†ãƒ ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
    expect(find.text('ãƒ†ã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ '), findsOneWidget);
    
    // ã‚¢ã‚¤ãƒ†ãƒ å®Œäº†
    await tester.tap(find.byType(Checkbox));
    await tester.pumpAndSettle();
    
    // å®Œäº†çŠ¶æ…‹ï¼ˆå–ã‚Šæ¶ˆã—ç·šï¼‰ãŒé©ç”¨ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
    final textWidget = tester.widget<Text>(find.text('ãƒ†ã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ '));
    expect(textWidget.style?.decoration, TextDecoration.lineThrough);
  });
  
  testWidgets('QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ â†’ ã‚¹ã‚­ãƒ£ãƒ³ â†’ å®¶æ—å‚åŠ ', (tester) async {
    await tester.pumpWidget(MyApp());
    
    // QRã‚³ãƒ¼ãƒ‰ç”»é¢ã‚’é–‹ã
    await tester.tap(find.byIcon(Icons.qr_code));
    await tester.pumpAndSettle();
    
    // QRã‚³ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
    expect(find.byType(QrImageView), findsOneWidget);
    expect(find.text('å®¶æ—ã‚’æ‹›å¾…'), findsOneWidget);
  });
});
```

#### 3.1.3 ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸãƒ†ã‚¹ãƒˆï¼ˆ15è¡Œï¼‰
```dart
// integration_test/realtime_test.dart
group('ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸãƒ†ã‚¹ãƒˆ', () {
  testWidgets('è¦ªãŒã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ  â†’ å­ã«å³åº§åæ˜ ', (tester) async {
    // è¦ªãƒ‡ãƒã‚¤ã‚¹ã§ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ 
    await DataService().addItem('list-123', 'æ–°ã—ã„ã‚¢ã‚¤ãƒ†ãƒ ');
    
    // å­ãƒ‡ãƒã‚¤ã‚¹å´ã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã‚’ç¢ºèª
    await tester.pumpAndSettle(Duration(seconds: 3));
    expect(find.text('æ–°ã—ã„ã‚¢ã‚¤ãƒ†ãƒ '), findsOneWidget);
  });
  
  testWidgets('å­ãŒã‚¢ã‚¤ãƒ†ãƒ å®Œäº† â†’ è¦ªã«å³åº§åæ˜ ', (tester) async {
    // å­ãƒ‡ãƒã‚¤ã‚¹ã§ã‚¢ã‚¤ãƒ†ãƒ å®Œäº†
    await DataService().completeItem('item-123');
    
    // è¦ªãƒ‡ãƒã‚¤ã‚¹å´ã§å®Œäº†çŠ¶æ…‹ãŒåæ˜ ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
    await tester.pumpAndSettle(Duration(seconds: 3));
    final textWidget = tester.widget<Text>(find.text('ãƒ†ã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ '));
    expect(textWidget.style?.decoration, TextDecoration.lineThrough);
  });
});
```

---

## ğŸ¬ 4. E2Eãƒ†ã‚¹ãƒˆè¨­è¨ˆï¼ˆ50è¡Œï¼‰

### 4.1 åŸºæœ¬ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆ

#### 4.1.1 ãƒ¡ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆï¼ˆ30è¡Œï¼‰
```dart
// integration_test/e2e_main_flow_test.dart
group('E2Eãƒ¡ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼', () {
  patrolTest('ãƒ­ã‚°ã‚¤ãƒ³ â†’ ãƒªã‚¹ãƒˆä½œæˆ â†’ ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ  â†’ å®Œäº†', (PatrolTester $) async {
    await $.pumpWidgetAndSettle(MyApp());
    
    // 1. ãƒ­ã‚°ã‚¤ãƒ³
    await $.tap(find.text('Googleã§ãƒ­ã‚°ã‚¤ãƒ³'));
    await $.pumpAndSettle();
    
    // 2. å®¶æ—ä½œæˆï¼ˆåˆå›ã®ã¿ï¼‰
    if (await $.exists(find.text('å®¶æ—ã‚’ä½œæˆ'))) {
      await $.tap(find.text('å®¶æ—ã‚’ä½œæˆ'));
      await $.enterText(find.byType(TextField), 'ãƒ†ã‚¹ãƒˆå®¶æ—');
      await $.tap(find.text('ä½œæˆ'));
      await $.pumpAndSettle();
    }
    
    // 3. ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ 
    await $.tap(find.byType(FloatingActionButton));
    await $.enterText(find.byType(TextField), 'ç‰›ä¹³');
    await $.tap(find.text('è¿½åŠ '));
    await $.pumpAndSettle();
    
    // 4. ã‚¢ã‚¤ãƒ†ãƒ ç¢ºèª
    expect(find.text('ç‰›ä¹³'), findsOneWidget);
    
    // 5. ã‚¢ã‚¤ãƒ†ãƒ å®Œäº†
    await $.tap(find.byType(Checkbox));
    await $.pumpAndSettle();
    
    // 6. å®Œäº†çŠ¶æ…‹ç¢ºèª
    final textWidget = $.tester.widget<Text>(find.text('ç‰›ä¹³'));
    expect(textWidget.style?.decoration, TextDecoration.lineThrough);
  });
});
```

#### 4.1.2 QRã‚³ãƒ¼ãƒ‰æ‹›å¾…ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆï¼ˆ20è¡Œï¼‰
```dart
// integration_test/e2e_qr_flow_test.dart
group('E2E QRæ‹›å¾…ãƒ•ãƒ­ãƒ¼', () {
  patrolTest('è¦ªãŒQRç”Ÿæˆ â†’ å­ãŒã‚¹ã‚­ãƒ£ãƒ³ â†’ å®¶æ—å‚åŠ ', (PatrolTester $) async {
    await $.pumpWidgetAndSettle(MyApp());
    
    // è¦ªå´ï¼šQRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
    await $.tap(find.byIcon(Icons.qr_code));
    await $.pumpAndSettle();
    
    // QRã‚³ãƒ¼ãƒ‰è¡¨ç¤ºç¢ºèª
    expect(find.byType(QrImageView), findsOneWidget);
    expect(find.text('å®¶æ—ã‚’æ‹›å¾…'), findsOneWidget);
    
    // å­å´ï¼šQRã‚¹ã‚­ãƒ£ãƒ³ï¼ˆãƒ¢ãƒƒã‚¯ï¼‰
    await $.tap(find.text('QRã‚¹ã‚­ãƒ£ãƒ³'));
    await $.pumpAndSettle();
    
    // å®¶æ—å‚åŠ æˆåŠŸç¢ºèª
    expect(find.text('å®¶æ—ã«å‚åŠ ã—ã¾ã—ãŸ'), findsOneWidget);
  });
});
```

### 4.2 ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ
```dart
// integration_test/e2e_error_test.dart
group('E2Eã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹', () {
  patrolTest('ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼æ™‚ã®é©åˆ‡ãªè¡¨ç¤º', (PatrolTester $) async {
    // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ‡æ–­çŠ¶æ…‹ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
    await NetworkSimulator.disconnect();
    
    await $.pumpWidgetAndSettle(MyApp());
    await $.tap(find.byType(FloatingActionButton));
    await $.enterText(find.byType(TextField), 'ãƒ†ã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ ');
    await $.tap(find.text('è¿½åŠ '));
    await $.pumpAndSettle();
    
    // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºç¢ºèª
    expect(find.text('ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ'), findsOneWidget);
  });
});
```

---

## ğŸ‘ï¸ 5. æ‰‹å‹•ãƒ†ã‚¹ãƒˆè¨­è¨ˆï¼ˆ30è¡Œï¼‰

### 5.1 å—å…¥ãƒ†ã‚¹ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

#### 5.1.1 æ©Ÿèƒ½å—å…¥ãƒ†ã‚¹ãƒˆï¼ˆ15é …ç›®ï¼‰
```
âœ… è¦ªãƒ¦ãƒ¼ã‚¶ãƒ¼å—å…¥ãƒ†ã‚¹ãƒˆ
â–¡ Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹
â–¡ QRã‚³ãƒ¼ãƒ‰ãŒç”Ÿæˆãƒ»è¡¨ç¤ºã•ã‚Œã‚‹  
â–¡ ãŠè²·ã„ç‰©ãƒªã‚¹ãƒˆã‚’ä½œæˆã§ãã‚‹
â–¡ å•†å“ã‚’è¿½åŠ ãƒ»ç·¨é›†ãƒ»å‰Šé™¤ã§ãã‚‹
â–¡ å­ã®å®Œäº†çŠ¶æ³ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç¢ºèªã§ãã‚‹

âœ… å­ãƒ¦ãƒ¼ã‚¶ãƒ¼å—å…¥ãƒ†ã‚¹ãƒˆ  
â–¡ Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹
â–¡ QRã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦å®¶æ—ã«å‚åŠ ã§ãã‚‹
â–¡ è¦ªãŒä½œæˆã—ãŸãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã§ãã‚‹
â–¡ å•†å“ã‚’ã€Œå®Œäº†ã€çŠ¶æ…‹ã«å¤‰æ›´ã§ãã‚‹
â–¡ å®Œäº†çŠ¶æ³ãŒè¦ªã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§åæ˜ ã•ã‚Œã‚‹

âœ… ã‚·ã‚¹ãƒ†ãƒ å—å…¥ãƒ†ã‚¹ãƒˆ
â–¡ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸãŒ5ç§’ä»¥å†…ã§å‹•ä½œã™ã‚‹
â–¡ ã‚¢ãƒ—ãƒªã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãŒç™ºç”Ÿã—ãªã„
â–¡ ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ™‚ã®é©åˆ‡ãªã‚¨ãƒ©ãƒ¼è¡¨ç¤º
â–¡ ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ãŒä¿ãŸã‚Œã‚‹
â–¡ å„ç¨®ãƒ‡ãƒã‚¤ã‚¹ã‚µã‚¤ã‚ºã§æ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹
```

#### 5.1.2 éæ©Ÿèƒ½å—å…¥ãƒ†ã‚¹ãƒˆï¼ˆ5é …ç›®ï¼‰
```
âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
â–¡ ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚é–“3ç§’ä»¥å†…
â–¡ ç”»é¢é·ç§»300msä»¥å†…
â–¡ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸ5ç§’ä»¥å†…

âœ… ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ
â–¡ æ“ä½œèª¬æ˜ãªã—ã§åŸºæœ¬æ©Ÿèƒ½ã‚’ä½¿ç”¨ã§ãã‚‹
â–¡ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒåˆ†ã‹ã‚Šã‚„ã™ã„
```

### 5.2 ãƒ‡ãƒã‚¤ã‚¹ãƒ†ã‚¹ãƒˆè¦ä»¶
- **å¯¾è±¡OS**: Android 8.0ä»¥ä¸Š
- **ç”»é¢ã‚µã‚¤ã‚º**: 5-7ã‚¤ãƒ³ãƒã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³
- **ãƒ†ã‚¹ãƒˆç«¯æœ«**: æœ€ä½3æ©Ÿç¨®ï¼ˆé«˜ãƒ»ä¸­ãƒ»ä½ã‚¹ãƒšãƒƒã‚¯å„1å°ï¼‰

### 5.3 ãƒªãƒªãƒ¼ã‚¹åˆ¤å®šåŸºæº–
- **ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒã‚°**: 0ä»¶ï¼ˆã‚¢ãƒ—ãƒªã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ»ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±ï¼‰
- **é«˜å„ªå…ˆåº¦ãƒã‚°**: 0ä»¶ï¼ˆä¸»è¦æ©Ÿèƒ½åœæ­¢ï¼‰
- **ä¸­å„ªå…ˆåº¦ãƒã‚°**: 3ä»¶ä»¥ä¸‹ï¼ˆè»½å¾®ãªä¸å…·åˆï¼‰
- **å—å…¥ãƒ†ã‚¹ãƒˆ**: 100%ãƒ‘ã‚¹ï¼ˆ20é …ç›®å…¨ã¦ï¼‰

---

## ğŸ› ï¸ 6. ãƒ†ã‚¹ãƒˆç’°å¢ƒï¼ˆ30è¡Œï¼‰

### 6.1 Supabaseãƒ†ã‚¹ãƒˆç’°å¢ƒè¨­å®š
```bash
# ãƒ†ã‚¹ãƒˆç”¨Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
SUPABASE_TEST_URL=http://localhost:54321
SUPABASE_TEST_ANON_KEY=test-anon-key
SUPABASE_TEST_SERVICE_ROLE_KEY=test-service-role-key
```

### 6.2 ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™
```sql
-- ãƒ†ã‚¹ãƒˆç”¨ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
INSERT INTO users (auth_id, name, role) VALUES 
('test-parent-001', 'ãƒ†ã‚¹ãƒˆè¦ª', 'parent'),
('test-child-001', 'ãƒ†ã‚¹ãƒˆå­', 'child');

INSERT INTO families (name, created_by_user_id) VALUES 
('ãƒ†ã‚¹ãƒˆå®¶æ—', (SELECT id FROM users WHERE auth_id = 'test-parent-001'));

INSERT INTO shopping_lists (family_id, title, created_by_user_id) VALUES 
((SELECT id FROM families WHERE name = 'ãƒ†ã‚¹ãƒˆå®¶æ—'), 'ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆ', 
 (SELECT id FROM users WHERE auth_id = 'test-parent-001'));

INSERT INTO shopping_items (shopping_list_id, name, created_by_user_id) VALUES 
((SELECT id FROM shopping_lists WHERE title = 'ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆ'), 'ãƒ†ã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ 1',
 (SELECT id FROM users WHERE auth_id = 'test-parent-001'));
```

### 6.3 CI/CDé€£æº
```yaml
# GitHub Actions ãƒ†ã‚¹ãƒˆå®Ÿè¡Œè¨­å®š
name: Test
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: subosito/flutter-action@v2
      - run: flutter test
      - run: flutter test integration_test/
```

### 6.4 ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰
```bash
# å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
flutter test

# çµåˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
flutter test integration_test/

# ã‚«ãƒãƒ¬ãƒƒã‚¸è¨ˆæ¸¬
flutter test --coverage
genhtml coverage/lcov.info -o coverage/html

# E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆå®Ÿæ©Ÿï¼‰
flutter drive --driver=test_driver/integration_test.dart --target=integration_test/e2e_test.dart
```

---

## ğŸ“Š 7. å“è³ªç›®æ¨™

### 7.1 å®šé‡ç›®æ¨™
| é …ç›® | MVPç›®æ¨™ | æ¸¬å®šæ–¹æ³• |
|------|--------|----------|
| **å˜ä½“ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸** | 80%ä»¥ä¸Š | lcov.info |
| **E2Eãƒ†ã‚¹ãƒˆæˆåŠŸç‡** | 100% | ãƒ†ã‚¹ãƒˆå®Ÿè¡Œçµæœ |
| **æ‰‹å‹•ãƒ†ã‚¹ãƒˆé …ç›®** | 20é …ç›® | ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ |
| **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“** | 5åˆ†ä»¥å†… | CI/CDå®Ÿè¡Œæ™‚é–“ |
| **ãƒã‚°æ¤œå‡ºç‡** | é‡è¦åº¦é«˜0ä»¶ | ãƒã‚°ç®¡ç†è¡¨ |

### 7.2 å“è³ªã‚²ãƒ¼ãƒˆ
- **Phase 4é–‹å§‹**: å˜ä½“ãƒ†ã‚¹ãƒˆ80%ä»¥ä¸Šã€åŸºæœ¬æ©Ÿèƒ½çµåˆãƒ†ã‚¹ãƒˆå®Œäº†
- **Phase 5é–‹å§‹**: E2Eãƒ†ã‚¹ãƒˆ100%æˆåŠŸã€ä¸»è¦ãƒã‚°ä¿®æ­£å®Œäº†
- **ãƒªãƒªãƒ¼ã‚¹åˆ¤å®š**: å…¨å—å…¥ãƒ†ã‚¹ãƒˆå®Œäº†ã€ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒã‚°0ä»¶

---

**ä½œæˆè€…**: QAã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢  
**ä½œæˆæ—¥**: 2025å¹´09æœˆ28æ—¥  
**æ‰¿èªçŠ¶æ³**: ãƒ‰ãƒ©ãƒ•ãƒˆ  
**ç·è¡Œæ•°**: 300è¡Œä»¥å†…é”æˆ  
**MVPé‡è¦–**: ã‚·ãƒ³ãƒ—ãƒ«ãƒ»ç¢ºå®Ÿãƒ»åŠ¹ç‡çš„ãªãƒ†ã‚¹ãƒˆè¨­è¨ˆ