# 📋 プロダクト要求仕様書 (PRD)
# おつかいポイント MVP版

---

## 📄 文書情報

| 項目 | 内容 |
|------|------|
| **文書タイトル** | おつかいポイント プロダクト要求仕様書 (PRD) |
| **バージョン** | v1.1 |
| **作成日** | 2025年09月21日 |
| **最終更新** | 2025年09月21日 |
| **承認状況** | ドラフト |
| **対象読者** | 全開発チームメンバー |

---

## 🎯 1. プロダクト概要

### 1.1 プロダクト名
**おつかいポイント**

### 1.2 プロダクトビジョン
親子でお買い物リストを簡単に共有できる、最もシンプルなモバイルアプリケーション

### 1.3 開発背景
- **前回プロジェクトの失敗**: 機能過多によりリリースに至らず
- **社長指示**: 「お買い物リストを共有できるアプリ」に特化
- **開発方針**: 極限まで機能を削減し、確実にリリースを達成

### 1.4 ビジネス目標
1. **主目標**: アプリの完成とリリース達成
2. **副目標**: 親子間でのお買い物リスト共有機能の実現

---

## 👥 2. ターゲットユーザー

### 2.1 プライマリーユーザー（親）
- **属性**: 30-45歳の保護者
- **ニーズ**: 子供にお買い物を頼みたい
- **行動**: リストを作成し、子供の進捗を確認

### 2.2 セカンダリーユーザー（子）
- **属性**: 8-16歳の子供
- **ニーズ**: 親からのお使いを確実に実行したい
- **行動**: リストを確認し、完了報告

### 2.3 ユーザーストーリー

#### 親のユーザーストーリー
```
As a 親
I want to お買い物リストを作成し子供と共有する
So that 子供に効率的にお使いを頼める
```

#### 子のユーザーストーリー
```
As a 子
I want to 親が作ったお買い物リストを確認する
So that 何を買えばいいか迷わずにお使いができる
```

---

## 🚀 3. MVP機能要件

### 3.1 機能概要図
```
親アプリ                     子アプリ
┌─────────────┐             ┌─────────────┐
│リスト作成    │ ←Supabase→ │リスト表示    │
│進捗確認     │   リアル    │完了報告     │
│QRコード生成  │   タイム   │家族参加     │
└─────────────┘   同期     └─────────────┘
```

### 3.2 詳細機能要件

#### 3.2.1 認証・アカウント管理

| 機能ID | 機能名 | 詳細 | 対象ユーザー |
|--------|--------|------|-------------|
| AUTH-001 | Google OAuth認証 | Google アカウントでのログイン | 親・子 |
| AUTH-002 | 初回ユーザー登録 | 名前・役割（親/子）の設定 | 親・子 |

#### 3.2.2 家族グループ管理

| 機能ID | 機能名 | 詳細 | 対象ユーザー |
|--------|--------|------|-------------|
| FAMILY-001 | QRコード生成 | 一意なQRコードを自動生成・表示 | 親 |
| FAMILY-002 | QRコードスキャン | QRコードスキャンで家族グループに参加 | 子 |
| FAMILY-003 | 家族メンバー表示 | 参加中の家族メンバー一覧表示 | 親・子 |

#### 3.2.3 お買い物リスト管理

| 機能ID | 機能名 | 詳細 | 対象ユーザー |
|--------|--------|------|-------------|
| LIST-001 | リスト作成 | 新しいお買い物リストの作成 | 親 |
| LIST-002 | 商品追加 | 商品名をテキスト入力で追加 | 親 |
| LIST-003 | 商品編集 | 商品名の変更 | 親 |
| LIST-004 | 商品削除 | 商品をリストから削除 | 親 |
| LIST-005 | リスト表示 | 現在のお買い物リスト表示 | 親・子 |
| LIST-006 | 商品完了 | 商品を「完了」状態に変更 | 子 |
| LIST-007 | 進捗確認 | 完了/未完了の状況確認 | 親 |

#### 3.2.4 リアルタイム同期

| 機能ID | 機能名 | 詳細 | 対象ユーザー |
|--------|--------|------|-------------|
| SYNC-001 | リアルタイム更新 | リスト変更の即座反映 | 親・子 |
| SYNC-002 | 状態同期 | 完了状態の即座共有 | 親・子 |

### 3.3 機能範囲外（明確に除外）

#### 3.3.1 削除された機能
- ❌ **ポイント・お小遣い機能**: 複雑性回避のため全面削除
- ❌ **承認・拒否フロー**: シンプル化のため削除
- ❌ **プッシュ通知**: 実装コスト削減のため削除
- ❌ **履歴管理**: MVP範囲外
- ❌ **写真アップロード**: MVP範囲外
- ❌ **分析・レポート機能**: MVP範囲外
- ❌ **チャット機能**: MVP範囲外

#### 3.3.2 今回対象外のプラットフォーム
- ❌ **iOS版**: Androidのみリリース（社長判断）
- ❌ **Web版**: モバイルアプリのみ

---

## 🎨 4. UI/UX要件

### 4.1 画面構成

#### 4.1.1 親用画面（3画面）
1. **ログイン画面**
   - Google OAuth ボタン
   - 初回登録フロー

2. **ホーム画面（リスト管理）**
   - QRコード表示エリア
   - お買い物リスト表示
   - 商品追加ボタン
   - 進捗表示（完了/未完了）

3. **商品追加・編集画面**
   - 商品名入力フィールド
   - 保存・キャンセルボタン

#### 4.1.2 子用画面（3画面）
1. **ログイン画面**
   - Google OAuth ボタン
   - 初回登録フロー

2. **QRコードスキャナー画面**
   - QRコードスキャナー
   - 参加ボタン

3. **リスト表示画面**
   - お買い物リスト表示
   - 各商品の完了ボタン
   - 完了済み商品の表示切り替え

### 4.2 デザイン要件
- **デザインシステム**: Material Design 3
- **カラーテーマ**: システム設定連動（ライト/ダーク）
- **フォント**: システム標準フォント
- **レスポンシブ**: Android各画面サイズ対応

---

## 🔧 5. 技術要件

### 5.1 技術スタック

| 分類 | 技術 | バージョン | 理由 |
|------|------|------------|------|
| **フロントエンド** | Flutter | 3.8+ | クロスプラットフォーム開発効率 |
| **言語** | Dart | 3.0+ | Flutter標準 |
| **バックエンド** | Supabase | 最新 | リアルタイム機能・Auth統合 |
| **データベース** | PostgreSQL | Supabase管理 | RLS・スケーラビリティ |
| **状態管理** | Riverpod | 2.5+ | 保守性・テスト容易性 |
| **認証** | Google OAuth | Supabase Auth | 簡単・安全 |

### 5.2 アーキテクチャ方針
- **Clean Architecture**: ビジネスロジックとUI分離
- **Repository Pattern**: データアクセス層の抽象化
- **Provider Pattern**: 依存性注入とテスタビリティ
- **モジュラー設計**: 機能別独立モジュール化による拡張性確保

### 5.3 プラットフォーム要件
- **対象OS**: Android 8.0 (API level 26) 以上
- **対象デバイス**: スマートフォンサイズ（5-7インチ）
- **ストア**: Google Play Store

---

## 📊 6. 非機能要件

### 6.1 パフォーマンス要件

| 項目 | 要件 | 測定方法 |
|------|------|----------|
| **アプリ起動時間** | 3秒以内 | 冷起動からホーム画面表示まで |
| **リアルタイム同期** | 5秒以内 | 変更から他デバイス反映まで |
| **画面遷移** | 300ms以内 | タップから画面表示まで |

### 6.2 セキュリティ要件
- **認証**: Google OAuth 2.0
- **データアクセス制御**: Supabase RLS（Row Level Security）
- **通信**: HTTPS通信のみ
- **個人情報**: 最小限のデータ収集

### 6.3 可用性要件
- **稼働率**: 99.0%（Supabaseインフラ依存）
- **データバックアップ**: Supabase自動バックアップ
- **災害復旧**: Supabase提供のDR機能

### 6.4 スケーラビリティ要件
- **想定ユーザー数**: 初期1,000ユーザー
- **同時接続**: 100ユーザー
- **データ容量**: 1GB（初期）

### 6.5 拡張性要件
- **新機能追加時の既存コード変更率**: 20%以下
- **機能別独立性**: モジュール間の依存関係最小化
- **プラグイン型設計**: 新機能の独立開発・テスト可能
- **API拡張性**: 後方互換性を保った機能追加

---

## 🧪 7. 受入基準

### 7.1 機能受入基準

#### 7.1.1 親ユーザー受入基準
- [ ] Google アカウントでログインできる
- [ ] QRコードが生成・表示される
- [ ] お買い物リストを作成できる
- [ ] 商品を追加・編集・削除できる
- [ ] 子の完了状況をリアルタイムで確認できる

#### 7.1.2 子ユーザー受入基準
- [ ] Google アカウントでログインできる
- [ ] QRコードをスキャンして家族に参加できる
- [ ] 親が作成したリストを表示できる
- [ ] 商品を「完了」状態に変更できる
- [ ] 完了状況が親にリアルタイムで反映される

#### 7.1.3 システム受入基準
- [ ] リアルタイム同期が5秒以内で動作する
- [ ] アプリクラッシュが発生しない
- [ ] オフライン時の適切なエラー表示
- [ ] データの整合性が保たれる

### 7.2 リリース基準
- [ ] 全機能の受入テスト完了
- [ ] パフォーマンステスト合格
- [ ] セキュリティ検証完了
- [ ] Google Play Console申請準備完了

---

## 📈 8. 成功指標（KPI）

### 8.1 開発KPI
| 指標 | 目標値 | 測定時期 |
|------|--------|----------|
| **リリース達成** | 100%（必達） | 2026年2月末 |
| **機能完成度** | 100% | リリース前 |
| **バグ発生率** | 重要度高: 0件 | リリース前 |
| **コード削減率** | 64%削減（前回プロジェクト比） | リリース前 |
| **拡張性指標** | 新機能追加時の既存コード変更率20%以下 | 新機能追加時 |

### 8.2 ユーザーKPI（リリース後）
| 指標 | 目標値 | 測定期間 |
|------|--------|----------|
| **アプリ起動率** | 週1回以上 | リリース後1ヶ月 |
| **リスト作成数** | ユーザー毎月2個以上 | リリース後1ヶ月 |
| **完了操作数** | リスト毎80%以上 | リリース後1ヶ月 |

---

## ⚠️ 9. リスク管理

### 9.1 技術リスク

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| Supabase障害 | 高 | 低 | ローカルキャッシュ実装 |
| Google OAuth API変更 | 中 | 低 | 公式ドキュメント追跡 |
| Flutter版本非互換 | 中 | 中 | 安定版使用・段階的更新 |

### 9.2 スケジュールリスク

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| 要件追加要求 | 高 | 高 | 厳格なスコープ管理 |
| 技術的難易度過小評価 | 中 | 中 | 早期プロトタイプ作成 |
| チームメンバー不足 | 中 | 低 | クロストレーニング実施 |

### 9.3 ビジネスリスク

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| 市場ニーズ誤解 | 低 | 中 | MVP早期リリース・フィードバック収集 |
| 競合他社先行リリース | 低 | 低 | 独自価値提案の明確化 |

---

## 📅 10. 開発スケジュール概要

### 10.1 主要マイルストーン
```
Phase 1: 設計・計画 (2025年10月)
├── PRD完成・承認
├── 技術設計完成
└── 開発環境構築

Phase 2: 開発実装 (2025年11月-2026年1月)
├── 認証機能実装
├── リスト管理機能実装
├── リアルタイム同期実装
└── UI/UX実装

Phase 3: テスト・リリース (2026年2月)
├── 統合テスト
├── 受入テスト
├── Google Play申請
└── 本番リリース
```

### 10.2 依存関係
- PRD承認後 → 技術設計開始可能
- Supabaseプロジェクト設定後 → バックエンド開発開始可能
- 認証機能完成後 → 全機能開発開始可能

---

## 👥 11. チーム役割・責任

### 11.1 開発チーム構成
- **プロダクトマネージャー**: PRD作成・進捗管理・品質管理
- **システムアーキテクト**: 技術設計・アーキテクチャ決定
- **ビジネスロジック担当**: データベース設計・Supabase設定
- **フロントエンドエンジニア**: Flutter実装・UI/UX実装
- **QAエンジニア**: テスト設計・品質保証
- **チームリーダー**: プロジェクト管理・リソース調整

### 11.2 コミュニケーション体制
- **週次進捗会議**: 毎週金曜日 16:00-17:00
- **デイリースタンドアップ**: 毎朝 9:30-9:45
- **スプリントレビュー**: 2週間毎
- **緊急連絡**: Slack #otsukaipoint-urgent

---

## 📋 12. 承認・変更管理

### 12.1 承認フロー
1. **PM作成** → **チームレビュー** → **ステークホルダー承認**
2. **承認者**: プロダクトマネージャー + チームリーダー
3. **承認基準**: 全チームメンバーの技術的実現可能性確認

### 12.2 変更管理
- **軽微な変更**: PMが判断・実行
- **機能追加**: ステークホルダー承認必須
- **スケジュール変更**: チームリーダー + PM協議

### 12.3 バージョン管理
- **メジャー変更**: v1.0 → v2.0
- **機能追加**: v1.0 → v1.1
- **バグ修正**: v1.0.0 → v1.0.1

### 12.4 更新履歴
- **v1.0** (2025年09月21日): 初版作成
- **v1.1** (2025年09月21日): 拡張性KPI追加、モジュラー設計方針追加

---

## 📞 13. 連絡先・参考資料

### 13.1 プロジェクト連絡先
- **プロダクトマネージャー**: [担当者名] - [メールアドレス]
- **技術リード**: [担当者名] - [メールアドレス]
- **プロジェクトSlack**: #otsukaipoint-dev

### 13.2 参考資料
- **技術ドキュメント**: /docs/技術設計書.md
- **UI/UXガイドライン**: /docs/デザインシステム.md
- **API仕様**: Supabase公式ドキュメント
- **コード削減分析**: OtsukaiPoint1_Code_Investigation_Report.md

---

**文書作成者**: ベテランプロダクトマネージャー  
**最終確認**: 2025年09月21日  
**次回レビュー予定**: 2025年10月1日